
# Escolhendo e carregando o arquivo em .csv
data = read.csv(file.choose(), header = T, sep = ",")

# Carregar apenas a variavel de interesse
x = data$largura_sepala

# A funcao fdaX calcula a distribuicao acumulada de uma funcao
fdaX = ecdf(x)

# O vetor valoresX carrega os valores de cada ponto da fda de X
valoresX = fdaX(x)

# Criando um iterador para o while
iterador = 0

# O boolean servirá para determinar se a distribuição em questão se adequa ou não ao conjunto de dados
deuCerto = TRUE

# Conta quantos testes foram bem-sucedidos para a distribuição em questão
contagemCertos = 0

# METODO DE MONTE CARLO: Os testes são repetidos diversas vezes. O numero escolhido foi 100

# A primeira dsitribuição testada é a distribuição normal
while(iterador < 100) {
  # A cada iteração, é criado um novo vetor que segue a dist. normal com a media e desvio padrao de X
  valoresTeste = fdaX(rnorm(x, mean(x), sd(x)))
  
  # Percorrendo todos os valores de cada vetor
  for(i in length(valoresX)) {
    # Aplicando a diferença de Kullback Liebler
    if(abs(valoresX[i] - valoresTeste[i]) > 0.05) {
      # Se a distância entre os dois valores excede um epsilon (o escolido foi 0.05)
      deuCerto = FALSE # o teste falha
      break;
    }
  }
  
  # Se o teste foi bem sucedido
  if(deuCerto) {
    # Aumenta a contagem de certos
    contagemCertos = contagemCertos + 1
  }
  
  # Incrementando o iterador do while
  iterador = iterador + 1
  
  # Resetando as variáveis utilizadas no escopo do while (em cada teste)
  valoresTeste = NULL
  i = 0
  deuCerto = TRUE
}

# Se a porcentagem de testes bem-sucedidos é inferior a 90%, consideramos que a distr. não é adequada ao conjunto de dados
if(contagemCertos <= 90) {
  print("A distribuição normal não se adequa ao conjunto de dados")
} else {
  print("A distribuição normal se adequa ao conjunto de dados")
}

# Informamos ao usuário a porcentagem de testes bem-sucedidos
print(c(contagemCertos, "%"))

# Resetando as variáveis utilizadas em cada distribuição
iterador = 0
contagemCertos = 0
deuCerto = TRUE

